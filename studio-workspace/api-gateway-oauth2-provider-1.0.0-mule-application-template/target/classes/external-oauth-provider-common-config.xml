<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:spring="http://www.mulesoft.org/schema/mule/spring"
      xmlns:os="http://www.mulesoft.org/schema/mule/os"
      xmlns:agw-client-store="http://www.mulesoft.org/schema/mule/agw-client-store"
      xsi:schemaLocation="
        http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
        http://www.mulesoft.org/schema/mule/agw-client-store http://www.mulesoft.org/schema/mule/agw-client-store/current/mule-agw-client-store.xsd
        http://www.mulesoft.org/schema/mule/spring http://www.mulesoft.org/schema/mule/spring/current/mule-spring.xsd
        http://www.mulesoft.org/schema/mule/os http://www.mulesoft.org/schema/mule/os/current/mule-os.xsd">

    <spring:config name="springConfig" files="external-oauth-provider-common-config-beans.xml"/>

    <os:config name="agwConfig">
        <agw-client-store:connection/>
    </os:config>

    <os:object-store name="clientObjectStore" persistent="true" config-ref="agwConfig"/>
    <os:object-store name="authorizationCodeObjectStore"
                     entryTtl="${authorization.code.ttl.value}"
                     entryTtlUnit="${authorization.code.ttl.unit}"
                     persistent="true"/>
    <os:object-store name="tokenObjectStore"
                     entryTtl="${token.ttl.value}"
                     entryTtlUnit="${token.ttl.unit}"
                     persistent="true"/>
    <os:object-store name="refreshTokenObjectStore" persistent="true"/>

    <spring:security-manager>
        <spring:delegate-security-provider name="clientSecurityProvider" delegate-ref="clientAuthenticationManager"/>
        <spring:delegate-security-provider name="resourceOwnerSecurityProvider" delegate-ref="resourceOwnerAuthenticationManager"/>
    </spring:security-manager>

</mule>
